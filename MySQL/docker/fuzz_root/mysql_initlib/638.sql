SET SESSION DEFAULT_STORAGE_ENGINE = MyISAM;
drop table if exists t0, t1, t2, t3, t4;
create table t0 ( key1 int not null, key2 int not null, key3 int not null, key4 int not null, key5 int not null, key6 int not null, key7 int not null, key8 int not null, INDEX i1(key1), INDEX i2(key2), INDEX i3(key3), INDEX i4(key4), INDEX i5(key5), INDEX i6(key6), INDEX i7(key7), INDEX i8(key8) );
insert into t0 values (1,1,1,1,1,1,1,1023),(2,2,2,2,2,2,2,1022);
set @d=2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
insert into t0 select key1+@d, key2+@d, key3+@d, key4+@d, key5+@d, key6+@d, key7+@d, key8-@d from t0;
set @d=@d*2;
analyze table t0;
explain select * from t0 where key1 < 3 or key1 > 1020;
explain select * from t0 where key1 < 3 or key2 > 1020;
select * from t0 where key1 < 3 or key2 > 1020;
explain select * from t0 where key1 < 2 or key2 <3;
explain select * from t0 where (key1 > 30 and key1<35) or (key2 >32 and key2 < 40);
select * from t0 where (key1 > 30 and key1<35) or (key2 >32 and key2 < 40);
explain select * from t0 ignore index (i2) where key1 < 3 or key2 <4;
explain select * from t0 where (key1 < 3 or key2 <4) and key3 = 50;
explain select * from t0 use index (i1,i2) where (key1 < 2 or key2 <3) and key3 = 50;
explain select * from t0 where (key1 > 1 or key2  > 2);
explain select * from t0 force index (i1,i2) where (key1 > 1 or key2  > 2);
explain select * from t0 where key1<2 or key2<3 or (key1>5 and key1<7) or (key1>10 and key1<12) or (key2>100 and key2<102);
explain select * from t0 where key2 = 45 or key1 <=> null;
explain select * from t0 where key2 = 45 or key1 is not null;
explain select * from t0 where key2 = 45 or key1 is null;
explain select * from t0 where key2=10 or key3=3 or key4 <=> null;
explain select * from t0 where key2=10 or key3=3 or key4 is null;
explain select key1 from t0 where (key1 <=> null) or (key2 < 2) or (key3=10) or (key4 <=> null);
explain select key1 from t0 where (key1 <=> null) or (key1 < 5) or (key3=10) or (key4 <=> null);
explain select * from t0 where (key1 < 2 or key2 < 2) and (key3 < 3 or key4 < 3) and (key5 < 5 or key6 < 5);
explain select * from t0 where (key1 < 2 or key2 < 4) and (key1 < 5 or key3 < 3);
select * from t0 where (key1 < 2 or key2 < 4) and (key1 < 5 or key3 < 3);
explain select * from t0 where (key1 < 3 or key2 < 2) and (key3 < 3 or key4 < 3) and (key5 < 2 or key6 < 2);
explain select * from t0 where (key1 < 3 or key2 < 3) and (key3 < 70);
explain select * from t0 where (key1 < 3 or key2 < 3) and (key3 < 1000);
explain select * from t0 where ((key1 < 3 or key2 < 3) and (key2 <4 or key3 < 3)) or key2 > 4;
explain select * from t0 where ((key1 < 4 or key2 < 4) and (key2 <4 or key3 < 3)) or key1 < 5;
select * from t0 where ((key1 < 4 or key2 < 4) and (key2 <4 or key3 < 3)) or key1 < 5;
explain select * from t0 where ((key1 < 2 or key2 < 2) and (key3 <4 or key5 < 3)) or ((key5 < 3 or key6 < 3) and (key7 <3 or key8 < 3));
explain select * from t0 where ((key3 <3 or key5 < 4) and (key1 < 3 or key2 < 3)) or ((key7 <5 or key8 < 3) and (key5 < 4 or key6 < 4));
explain select * from t0 where ((key3 <3 or key5 < 4) and (key1 < 3 or key2 < 4)) or ((key3 <4 or key5 < 2) and (key5 < 5 or key6 < 3));
explain select * from t0 where ((key3 <4 or key5 < 3) and (key1 < 3 or key2 < 3)) or (((key3 <5 and key7 < 5) or key5 < 2) and (key5 < 4 or key6 < 4));
explain select * from t0 where ((key3 <5 or key5 < 4) and (key1 < 4 or key2 < 4)) or ((key3 >5 or key5 < 2) and (key5 < 5 or key6 < 6));
explain select * from t0 force index(i1, i2, i3, i4, i5, i6 ) where ((key3 <3 or key5 < 4) and (key1 < 3 or key2 < 3)) or ((key3 >4 or key5 < 2) and (key5 < 5 or key6 < 4));
explain select * from t0 force index(i1, i2, i3, i4, i5, i6 ) where ((key3 <5 or key5 < 4) and (key1 < 4 or key2 < 4)) or ((key3 >=5 or key5 < 2) and (key5 < 5 or key6 < 6));
select * from t0 where key1 < 3 or key8 < 2 order by key1;
explain select * from t0 where key1 < 3 or key8 < 2 order by key1;
create table t2 like t0;
insert into t2 select * from t0;
alter table t2 add index i1_3(key1, key3);
alter table t2 add index i2_3(key2, key3);
alter table t2 drop index i1;
alter table t2 drop index i2;
alter table t2 add index i321(key3, key2, key1);
analyze table t2;
explain select key3 from t2 where key1 = 100 or key2 = 100;
explain select key3 from t2 where key1 <100 or key2 < 100;
explain select key7 from t2 where key1 <100 or key2 < 100;
create table t4 ( key1a int not null, key1b int not null, key2  int not null, key2_1 int not null, key2_2 int not null, key3  int not null, index i1a (key1a, key1b), index i1b (key1b, key1a), index i2_1(key2, key2_1), index i2_2(key2, key2_1) );
insert into t4 select key1,key1,key1 div 10, key1 % 10, key1 % 10, key1 from t0;
analyze table t4;
select * from t4 where key1a = 3 or key1b = 4;
explain select * from t4 where key1a = 3 or key1b = 4;
explain select * from t4 where key2 = 1 and (key2_1 = 1 or key3 = 5);
explain select * from t4 where key2 = 1 and (key2_1 = 1 or key2_2 = 5);
explain select * from t4 where key2_1 = 1 or key2_2 = 5;
create table t1 like t0;
insert into t1 select * from t0;
analyze table t1;
explain select * from t0 left join t1 on (t0.key1=t1.key1) where t0.key1=3 or t0.key2=4;
select * from t0 left join t1 on (t0.key1=t1.key1) where t0.key1=3 or t0.key2=4;
explain select * from t0,t1 where (t0.key1=t1.key1) and ( t0.key1=3 or t0.key2=4);
explain select * from t0,t1 where (t0.key1=t1.key1) and (t0.key1=3 or t0.key2=4) and t1.key1<200;
explain select * from t0,t1 where (t0.key1=t1.key1) and (t0.key1=3 or t0.key2<4) and t1.key1=2;
explain select * from t0,t1 where t0.key1 = 5 and (t1.key1 = t0.key1 or t1.key8 = t0.key1);
explain select * from t0,t1 where t0.key1 < 3 and (t1.key1 = t0.key1 or t1.key8 = t0.key1);
explain select * from t1 where key1=3 or key2=4 union select * from t1 where key1<4 or key3=5;
explain select * from (select * from t1 where key1 = 3 or key2 =3) as z where key8 >5;
create table t3 like t0;
insert into t3 select * from t0;
alter table t3 add key9 int not null, add index i9(key9);
alter table t3 add keyA int not null, add index iA(keyA);
alter table t3 add keyB int not null, add index iB(keyB);
alter table t3 add keyC int not null, add index iC(keyC);
update t3 set key9=key1,keyA=key1,keyB=key1,keyC=key1;
analyze table t3;
explain select * from t3 where key1=1 or key2=2 or key3=3 or key4=4 or key5=5 or key6=6 or key7=7 or key8=8 or key9=9 or keyA=10 or keyB=11 or keyC=12;
select * from t3 where key1=1 or key2=2 or key3=3 or key4=4 or key5=5 or key6=6 or key7=7 or key8=8 or key9=9 or keyA=10 or keyB=11 or keyC=12;
explain select * from t0 where key1 < 3 or key2 < 4;
select * from t0 where key1 < 3 or key2 < 4;
update t0 set key8=123 where key1 < 3 or key2 < 4;
analyze table t0;
select * from t0 where key1 < 3 or key2 < 4;
delete from t0 where key1 < 3 or key2 < 4;
analyze table t0;
select * from t0 where key1 < 3 or key2 < 4;
select count(*) from t0;
drop table t4;
create table t4 (a int);
insert into t4 values (1),(4),(3);
analyze table t4;
set @save_join_buffer_size=@@join_buffer_size;
set join_buffer_size= 4096;
explain select max(a.key1 + b.key1 + a.key2 + b.key2 + a.key3 + b.key3 + a.key4 + b.key4 + a.key5 + b.key5) from t0 as a force index(i1,i2), t0 as b force index (i1,i2) where (a.key1 < 500000 or a.key2 < 3) and   (b.key1 < 500000 or b.key2 < 3);
select max(a.key1 + b.key1 + a.key2 + b.key2 + a.key3 + b.key3 + a.key4 + b.key4 + a.key5 + b.key5) from t0 as a force index(i1,i2), t0 as b force index (i1,i2) where (a.key1 < 500000 or a.key2 < 3) and   (b.key1 < 500000 or b.key2 < 3);
update t0 set key1=1;
analyze table t0;
explain select max(a.key1 + b.key1 + a.key2 + b.key2 + a.key3 + b.key3 + a.key4 + b.key4 + a.key5 + b.key5) from t0 as a force index(i1,i2), t0 as b force index (i1,i2) where (a.key1 = 1 or a.key2 = 1) and   (b.key1 = 1 or b.key2 = 1);
